<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<head>
<meta charset="utf-8">
<link
	rel="icon"
	href="../../favicon.ico">
<link
	href="css/bootstrap.min.css"
	rel="stylesheet">
<title>Profile</title>
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script
	src="js/jquery.validate.js"
	type="text/javascript"></script>
<script
	src="js/customjslib.js"
	type="text/javascript"></script>
<script type="text/javascript">
	$(document)
			.ready(
					function() {
						$("#editButton").on("click", function() {
							makeEditable();
							return false;
						});

						$("#saveChanges").click(function() {
							return matchPasswords();
						});

						$("#profile_form")
								.validate(
										{
											focusCleanup : true,
											rules : {
												nickname : {
													minlength : 2,
													maxlength : 32
												},
												name : {
													minlength : 2,
													maxlength : 64
												},
												password : {
													minlength : 5,
													maxlength : 64
												},
											},
											messages : {
												nickname : {
													required : "Especifica un apodo",
													minlength : "El apodo debe tener 2 caracteres como mínimo",
													maxlength : "Máximo 32 caracteres",
												},
												name : {
													minlength : "El nombre debe tener 2 caracteres como mínimo",
													maxlength : "Máximo 64 caracteres",
												},
												password : {
													minlength : "La contraseña debe tener al menos 5 caracteres",
													maxlength : "Máximo 64 caracteres",
												},
											},
											errorPlacement : function(error,
													element) {
												error.insertBefore(element);
												error.addClass("red");
											},
											highlight : function(element) {
												$(element).removeClass(
														"border-red");
											},
											unhighlight : function(element) {
												$(element).removeClass(
														"border-red");
												// TODO: RED STYLE ERRORS
											},
										});
					});
</script>
</head>
<body>
	<div>
		MY PROFILE PAGE: <span th:text="${session.user.name}"></span>
	</div>
	<div>
		<form
			action="#"
			th:action="@{/landing}"
			method="get">
			<input
				type="submit"
				value="Return to landing page">
		</form>
		<button id="editButton">Click to Edit</button>
		<form
			class="form"
			action="#"
			id="profile_form"
			th:action="@{/updateUser}"
			th:object="${user}"
			method="post"
			enctype="multipart/form-data">
			<h2 class="form-heading">Profile</h2>
			<label
				for="nickname"
				class="">Nickname</label>
			<input
				type="text"
				th:field="*{nickname}"
				id="nickname"
				name="nickname"
				class="form-control editable"
				th:placeholder="*{nickname}"
				required
				disabled="disabled"
				readonly="readonly">
			<span
				th:if="${#fields.hasErrors('nickname')}"
				th:errors="*{nickname}">Nickname error</span>
			<label
				for="name"
				class="">Name</label>
			<input
				type="text"
				th:field="*{name}"
				id="name"
				name="name"
				class="form-control editable"
				th:placeholder="*{name}"
				required
				disabled="disabled"
				readonly="readonly">
			<label
				for="avatar"
				class="">Avatar</label>
			<input
				type="file"
				name="avatar_image"
				id="avatar"
				accept="image/*"
				class="form-control editable"
				disabled="disabled"
				readonly="readonly">
			<label
				for="inputPassword"
				class="">Password</label>
			<input
				type="password"
				th:field="*{password}"
				id="inputPassword"
				name="password"
				class="form-control editable"
				placeholder="Insert password to confirm"
				required
				disabled="disabled"
				readonly="readonly">
			<label
				for="checkPassword"
				class="">Retype password</label>
			<input
				type="password"
				name="checkPassword"
				id="checkPassword"
				class="form-control editable"
				placeholder="Retype password for security"
				required
				disabled="disabled"
				readonly="readonly">
			<input
				class="editable"
				type="submit"
				id="saveChanges"
				value="Save Changes"
				disabled="disabled">
		</form>
	</div>
</body>
</html>